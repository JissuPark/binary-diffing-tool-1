import os
import json
from pprint import pprint
import timeit

def read_json(PATH):
    with open(PATH, "r", encoding="UTF-8") as json_file:
        json_data = json.load(json_file)
        return json_data

s = timeit.default_timer()

BASE = "C:\\Users\\E-2\\Desktop\\white_hashSet\\"

file_list = list()
file_name = list()
for _dir in os.listdir(BASE):
    file_name.append(os.listdir(BASE + _dir)[0])
    file_list.append(BASE + _dir + '\\' + os.listdir(BASE + _dir)[0])

save_dic = dict()
for mal_set in file_list:
    print(f'[Debug] STAND SET - {mal_set}')
    mal_hash_set = read_json(mal_set)
    for cmp_mal_set in file_list:
        if mal_set != cmp_mal_set:
            cmp_hash_set = read_json(cmp_mal_set)
            for mal_hash in mal_hash_set:
                if mal_hash in cmp_hash_set or mal_hash in save_dic:
                    pass
                else:
                    save_dic.update({mal_hash:mal_hash_set[mal_hash]})
            del cmp_hash_set
    del mal_hash_set
            
with open(BASE + "final.hashSet", 'w') as makefile:
    json.dump(save_dic, makefile, ensure_ascii=False, indent='\t')


print(f'[INFO] running time {timeit.default_timer() - s}')